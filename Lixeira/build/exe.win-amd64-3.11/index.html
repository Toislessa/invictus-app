<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Relatório</title>

    <style>
        body, html {
            height: 100%;
            margin: 0;
            padding: 0;
            overflow: hidden;
        }
        iframe {
            height:100%;
            width:100%;
            border: none;
        }
    </style>

    <script>
    // Armazene a posição de rolagem em uma variável
    var scrollPosition = 0;

    setInterval(function() {
        fetch('/status')
        .then(response => response.text())
        .then(status => {
            if (status === 'done') {
                // Antes de atualizar o iframe, armazene a posição de rolagem atual
                var iframe = document.getElementById('output');
                scrollPosition = iframe.contentWindow.pageYOffset || iframe.contentDocument.documentElement.scrollTop;
                sessionStorage.setItem('scrollPosition', scrollPosition);

                // Atualize o iframe
                iframe.src = "/output.html";

                // Após a atualização, restaure a posição de rolagem
                iframe.onload = function() {
                    scrollPosition = sessionStorage.getItem('scrollPosition');
                    iframe.contentWindow.scrollTo(0, scrollPosition);
                };
            }
        });
    }, 5000);
    </script>
</head>
<body>
    <iframe id="output" src="/output.html" width="100%" height="100vh"></iframe>

</body>
</html>
